async function GptAcademicJavaScriptInit(dark,prompt,live2d,layout,tts){audio_fn_init();minor_ui_adjustment();ButtonWithDropdown_init();update_conversation_metadata();window.addEventListener("gptac_restore_chat_from_local_storage",restore_chat_from_local_storage);const welcomeMessage=new WelcomeMessage();welcomeMessage.begin_render();chatbotIndicator=gradioApp().querySelector('#gpt-chatbot > div.wrap');var chatbotObserver=new MutationObserver(()=>{chatbotContentChanged(1);welcomeMessage.update();});chatbotObserver.observe(chatbotIndicator,{attributes:true,childList:true,subtree:true});if(layout==="LEFT-RIGHT"){chatbotAutoHeight();}
if(layout==="LEFT-RIGHT"){limit_scroll_position();}
let searchString="";let bool_value="";if(getCookie("js_darkmode_cookie")){dark=getCookie("js_darkmode_cookie")}
dark=dark=="True";if(document.querySelectorAll('.dark').length){if(!dark){document.querySelectorAll('.dark').forEach(el=>el.classList.remove('dark'));}}else{if(dark){document.querySelector('body').classList.add('dark');}}
if(tts!="DISABLE"){enable_tts=true;if(getCookie("js_auto_read_cookie")){auto_read_tts=getCookie("js_auto_read_cookie")
auto_read_tts=auto_read_tts=="True";if(auto_read_tts){allow_auto_read_tts_flag=true;}}}
gpt_academic_gradio_saveload("load","elem_prompt","js_system_prompt_cookie",null,"str");gpt_academic_gradio_saveload("load","elem_temperature","js_temperature_cookie",null,"float");if(getCookie("js_md_dropdown_cookie")){const cached_model=getCookie("js_md_dropdown_cookie");var model_sel=await get_gradio_component("elem_model_sel");if(model_sel.props.choices.includes(cached_model)){gpt_academic_gradio_saveload("load","elem_model_sel","js_md_dropdown_cookie",null,"str");push_data_to_gradio_component({label:'当前模型：'+getCookie("js_md_dropdown_cookie"),__type__:'update'},"gpt-chatbot","obj")}}
if(getCookie("js_clearbtn_show_cookie")){bool_value=getCookie("js_clearbtn_show_cookie")
bool_value=bool_value=="True";searchString="输入清除键";if(bool_value){let clearButton=document.getElementById("elem_clear");clearButton.style.display="block";let clearButton2=document.getElementById("elem_clear2");clearButton2.style.display="block";let arr_with_clear_btn=update_array(await get_data_from_gradio_component('cbs'),"输入清除键","add")
push_data_to_gradio_component(arr_with_clear_btn,"cbs","no_conversion");}else{let clearButton=document.getElementById("elem_clear");clearButton.style.display="none";let clearButton2=document.getElementById("elem_clear2");clearButton2.style.display="none";let arr_without_clear_btn=update_array(await get_data_from_gradio_component('cbs'),"输入清除键","remove")
push_data_to_gradio_component(arr_without_clear_btn,"cbs","no_conversion");}}
if(getCookie("js_live2d_show_cookie")){searchString="添加Live2D形象";bool_value=getCookie("js_live2d_show_cookie");bool_value=bool_value=="True";if(bool_value){loadLive2D();let arr_with_live2d=update_array(await get_data_from_gradio_component('cbsc'),"添加Live2D形象","add")
push_data_to_gradio_component(arr_with_live2d,"cbsc","no_conversion");}else{try{$('.waifu').hide();let arr_without_live2d=update_array(await get_data_from_gradio_component('cbsc'),"添加Live2D形象","remove")
push_data_to_gradio_component(arr_without_live2d,"cbsc","no_conversion");}catch(error){}}}else{if(live2d){loadLive2D();}else{}}
change_theme("","")}